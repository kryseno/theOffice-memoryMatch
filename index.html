<!doctype html>
<html>
    <head>
        <title>Memory Match Game</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            var first_card_clicked = null;
            var second_card_clicked = null;
            var total_possible_matches = 9;
            var matches = 0;
            var attempts = 0;
            var accuracy = 0;
            var games_played = 0;
            var allow_card_click = true;
            var imagesArr = [
//                'andy', 'dwight', 'gabe', 'jim', 'kevin', 'michael', 'pam', 'stanley', 'toby',
//                'andy', 'dwight', 'gabe', 'jim', 'kevin', 'michael', 'pam', 'stanley', 'toby'];
                'images/andy.jpg',
                'images/dwight.jpg',
                'images/gabe.jpg',
                'images/jim.jpg',
                'images/kevin.jpg',
                'images/michael.jpg',
                'images/pam.jpg',
                'images/stanley.jpg',
                'images/toby.jpg',
                'images/andy.jpg',
                'images/dwight.jpg',
                'images/gabe.jpg',
                'images/jim.jpg',
                'images/kevin.jpg',
                'images/michael.jpg',
                'images/pam.jpg',
                'images/stanley.jpg',
                'images/toby.jpg'

            ];

//            FOR RESET I WANT TO:
//            1. have cards return to game-area
//            2. back of card showing
//            3. reshuffle (re-randomize cards)
//            4. reset attempts & accuracy, games_played++

            $(document).ready(initializeApplication);

            function initializeApplication(){
                assembleCards();
                $(".card").click(card_clicked);
            }
            function card_clicked(){
//                console.log('handle click called');
                if(!allow_card_click){
                    return;
                }

                if($(this).hasClass('reveal')){
                    console.log('this card has already been clicked');
                    return;
                }

                $(this).addClass('reveal');
//                console.log('card clicked');

                if(first_card_clicked === null){
//                    console.log('first card was clicked');
                    first_card_clicked = this;
                    return;
                } else {
//                    console.log('second card was clicked');
                    second_card_clicked = this;
                    attempts++;
                    console.log('attempt #: ' + attempts);
                    display_stats();
                    allow_card_click = false;

                    if($(first_card_clicked).find('.front img').attr('src') === $(second_card_clicked).find('.front img').attr('src')){
                        console.log('the cards matched!');
                        matches++;
                        console.log('match_counter: ' + matches);
                        accuracy = Math.floor((matches / attempts) * 100) + '%';
                        console.log('accuracy: ' + accuracy);

                        setTimeout(pause_after_matched, 1000);
                        function pause_after_matched(){
                            $(first_card_clicked).css('visibility', 'hidden');
                            $(second_card_clicked).css('visibility', 'hidden');
                            first_card_clicked = null;
                            second_card_clicked = null;
                            allow_card_click = true;
                        }

                        if(matches === total_possible_matches){
                            console.log('You won!');
                        } else {
                            return;
                        }

                    } else {
                        console.log("turning off click at "+window.performance.now());
                        allow_card_click = false;
                        console.log('not a match');
                        var timeOut = setTimeout(function () {
                            console.log('starting to flip back cards '+window.performance.now())
                            $(first_card_clicked).removeClass('reveal');
//                            console.log('back of 1st card now shown');
                            first_card_clicked = null;
//                            console.log('first_card_clicked is null');
                            $(second_card_clicked).removeClass('reveal');
//                            console.log('back of 2nd card now shown');
                            second_card_clicked = null;
//                            console.log('second_card_clicked is null');
                            allow_card_click = true;
                            console.log("done flipping back cards" +window.performance.now())
                        }, 2000);
                        console.log('2 seconds passed');

                        console.log("turning on click at "+window.performance.now());
                        return timeOut;
                    }
                }

            }



//            1. X ****** disable other clicks from happening during game and during setTimeout
//            2. X ******* how to have cards pause when matched, and then disappear
//            3. X how to have live display stats in stats container
//            4. reset button not working
//            5. X add images to divs
//            6. X randomize when load
//            7. edit styling
//            7.5. crop photos to make faces show better
//            8. add audio -when everything works
//            9. card flip - fade effect
//            10. vid - victory and lose
//            11. modal - 2 divs, 1 #modal shadow, 1#modal body, modal shadow = position: fixed; full size of viewport;opacity 0.7 bg black; run to see, zindex 1 (so above everything), modal body (same positioning, except needs to be in middle 50% which is top left corner, shift left & up :translate); bg color white, give size(height/width); display none/or visibilty; make function to show it, make X to close (close function)

            function assembleCards(){
                randomizeImagesArray(imagesArr);
                for (var i = 0; i < imagesArr.length; i++){
                    var make_card = $("<div>").addClass('card');
                        var make_front_card = $("<div>").addClass('front');
                        var make_front_img = $("<img>").attr('src', imagesArr[i]);
                    $(make_front_card).append(make_front_img);
                        var make_back_card = $("<div>").addClass('back');
                        var make_back_img = $("<img>").attr('src', 'images/dunderMifflin.png', 'alt', 'dunder mifflin');
                    $(make_back_card).append(make_back_img);
                    $(make_card).append(make_front_card, make_back_card);
                    $(".game-area").append(make_card);
                }
            }

            function randomizeImagesArray(array){
                for (var i = array.length - 1; i > 0; i--){
                    var j = Math.floor(Math.random() * (i + 1));
                    var hold = array[i];
                    array[i] = array[j];
                    array[j] = hold;
                }
                return array;
            }

            function display_stats(){
                $(".games-played .value").empty();
                $(".games-played .value").append(games_played);
                $(".attempts .value").empty();
                $(".attempts .value").append(attempts);
                $(".accuracy .value").empty();
                $(".accuracy .value").append(accuracy);
            }

            function reset_stats(){
                accuracy = 0;
                matches = 0;
                attempts = 0;
                display_stats();
            }

            $(".reset").on("click", function(){
                games_played++;
                reset_stats();
                display_stats();
                card_clicked();
            });

        </script>
    </head>
    <body>

            <header>
                <img id="logo" src="images/dunderMifflin.png" alt="Dunder Mifflin Logo">
                <div class="center">
                    <img id="office_sign" src="images/the_office_sign.jpg" alt="">
                    <!--<div id="title"><h1>Memory<br>Match<br>Game</h1></div>-->
                    <nav>
                        <ul>
                            <li><a href="">settings</a></li>
                            <li><a href="about.html">about</a></li>
                        </ul>
                    </nav>
                </div>
                <img id="peoplePersonsImg" src="images/peoplePersons.jpg" alt="The People Person's Paper People">

            </header>

            <div class="stats_container">
                <div class="games-played">
                    <div class="label">Games Played</div>
                    <hr>
                    <div class="value">0</div>
                    <hr>
                </div>
                <div class="attempts">
                    <div class="label">Attempts</div>
                    <hr>
                    <div class="value">0</div>
                    <hr>
                </div>
                <div class="accuracy">
                    <div class="label">Accuracy</div>
                    <hr>
                    <div class="value">0</div>
                    <hr>
                </div>
                <button class="reset">Reset Game</button>
            </div>

            <div class="game-area">
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/michael.jpg" alt="michael">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/michael.jpg" alt="michael">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/dwight.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/dwight.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/jim.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/jim.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back"><img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/andy.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/andy.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/kevin.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/kevin.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/gabe.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/gabe.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/pam.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/pam.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/stanley.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/stanley.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/toby.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="card">-->
                    <!--<div class="front">-->
                        <!--<img src="images/toby.jpg" alt="">-->
                    <!--</div>-->
                    <!--<div class="back">-->
                        <!--<img src="images/dunderMifflin.png" alt="dunder mifflin">-->
                    <!--</div>-->
                <!--</div>-->
            </div>

    </body>
</html>